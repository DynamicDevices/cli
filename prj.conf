#
# Copyright (c) 2020 Nordic Semiconductor
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#

# Network shell
CONFIG_SHELL=y
CONFIG_SHELL_ARGC_MAX=26
CONFIG_SHELL_CMD_BUFF_SIZE=416

CONFIG_NET_L2_OPENTHREAD=y

# Generic networking options
CONFIG_NETWORKING=y

CONFIG_MBEDTLS_SHA1_C=n
CONFIG_FPU=y

CONFIG_GPIO_SHELL=n

# Matter build not working...
#CONFIG_CHIP=y
#CONFIG_CHIP_LIB_SHELL=

# OpenThread

CONFIG_OPENTHREAD_SHELL=y

# Default mesh settings

# NOTE: We are using our own Kconfig for PAN ID as the Openthread
#       one seems to break with numbers that are too big like 0x4444
#       Maybe it's treating it as byte somewhere ???
CONFIG_OPENTHREAD_PANID=42104
CONFIG_OPENTHREAD_WORKING_PANID=0x4444
CONFIG_OPENTHREAD_XPANID="33:33:33:33:44:44:44:44"
CONFIG_OPENTHREAD_NETWORK_NAME="INST"
CONFIG_OPENTHREAD_NETWORKKEY="33:33:44:44:33:33:44:44:33:33:44:44:33:33:44:44"
CONFIG_OPENTHREAD_CHANNEL=15

# This needs to be false for the above settings to take effect inside OpenThread
# But then we seem to have problems with the PANID so instead use our own
# programmatic code in main.c which is called by setting this to 'y'
#CONFIG_OPENTHREAD_MANUAL_START=y

CONFIG_OPENTHREAD_UPTIME=y

# MQTT-SNCLIENT
CONFIG_MQTT_SNCLIENT_TOPIC_PREFIX="ot"

# Bluetooth ---

# NEED TO SET THIS UNIQUELY IN APPLICATION
CONFIG_BT_DEVICE_NAME="nRF528xx"

CONFIG_BT=y
#CONFIG_BT_DEBUG_LOG=y
CONFIG_BT_CENTRAL=y
CONFIG_BT_SMP=y
CONFIG_BT_GATT_CLIENT=y
CONFIG_BT_GATT_DM=y
CONFIG_HEAP_MEM_POOL_SIZE=4096
CONFIG_BT_BAS_CLIENT=n

CONFIG_BT_SCAN=y
CONFIG_BT_SCAN_FILTER_ENABLE=y
CONFIG_BT_SCAN_UUID_CNT=1
CONFIG_BT_PRIVACY=y

CONFIG_BT_SETTINGS=y
CONFIG_FLASH=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_FLASH_MAP=y
CONFIG_NVS=y
CONFIG_SETTINGS=y

# For this to work in the app we need to increase the
# main stack size
CONFIG_MAIN_STACK_SIZE=4096

# End Bluetooth ---

# Drivers

# Support temperature sensor
CONFIG_NRFX_TEMP=y

# TODO: Support USB update without booting into DFU mode
#CONFIG_STREAM_FLASH=y
#CONFIG_IMG_MANAGER=y
#CONFIG_USB_DFU_CLASS=y
#CONFIG_USB_DFU_REBOOT=y

# Trying to sort out Multiprotocol
CONFIG_MPSL=y
CONFIG_MPSL_ASSERT_HANDLER=y
CONFIG_MPSL_LOG_LEVEL_DBG=y
#CONFIG_MPSL_WORK_STACK_SIZE=4096

# Logging
CONFIG_LOG=y
# Don't defer as when things break badly we want to have a chance
# of seeing errors...
CONFIG_LOG_PROCESS_THREAD=y
CONFIG_LOG_MODE_DEFERRED=n
#CONFIG_LOG_MAX_LEVEL=4
##CONFIG_OPENTHREAD_DEBUG=y
##CONFIG_OPENTHREAD_L2_DEBUG=y
#CONFIG_OPENTHREAD_LOG_LEVEL_WARN=y
##CONFIG_OPENTHREAD_LOG_LEVEL_DEBG=y

# Logging modules
CONFIG_OT_COMMAND_LINE_INTERFACE_LOG_LEVEL_INF=y
CONFIG_MQTT_SNCLIENT_LOG_LEVEL_DBG=y
CONFIG_LNS_CLIENT_LOG_LEVEL_DBG=y

# Enable OpenThread features set
#CONFIG_OPENTHREAD_MTD=y
CONFIG_OPENTHREAD_FTD=y
#CONFIG_OPENTHREAD_SLAAC=y

# Minimise size
#CONFIG_NET_SOCKETS=n
#CONFIG_OPENTHREAD_SHELL=n
#CONFIG_COAP=n
#CONFIG_COAP_UTILS=n
#CONFIG_OPENTHREAD_COAP=n

#CONFIG_NRF_802154_SER_LOG=y

#CONFIG_ASSERT=y

#CONFIG_ISR_STACK_SIZE=4096
#CONFIG_IDLE_STACK_SIZE=1024
#CONFIG_BT_RX_STACK_SIZE=4096
#CONFIG_SHELL_STACK_SIZE=8192
#CONFIG_NET_RX_STACK_SIZE=4096
#CONFIG_NET_TX_STACK_SIZE=4096
#CONFIG_MPSL_WORK_STACK_SIZE=4096
#CONFIG_PRIVILEGED_STACK_SIZE=2048
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=8192
#CONFIG_OPENTHREAD_RADIO_WORKQUEUE_STACK_SIZE=4096
#CONFIG_IPC_SERVICE_BACKEND_RPMSG_WQ_STACK_SIZE=2048

# Wait for serial console or start up straight away
CONFIG_WAIT_FOR_CLI_CONNECTION=y

# Enable multithread support in gdb
CONFIG_DEBUG=y
CONFIG_THREAD_MONITOR=y
CONFIG_THREAD_STACK_INFO=y
CONFIG_TIMESLICING=n
CONFIG_THREAD_NAME=y
CONFIG_DEBUG_THREAD_INFO=y
CONFIG_OPENTHREAD_SOURCES=y

# Enable asserts
#CONFIG_ASSERT=y
#CONFIG_ASSERT_NO_COND_INFO=y

# Bluetooth
#CONFIG_APP_BLUETOOTH_LOG_LEVEL_DBG=y
#CONFIG_BT_SCAN_LOG_LEVEL_DBG=y
#CONFIG_BT_HCI_CORE_LOG_LEVEL_DBG=y
CONFIG_BT_EXT_ADV=y
CONFIG_BT_RX_STACK_SIZE=4096
CONFIG_BT_HCI_TX_STACK_SIZE=4096
CONFIG_BT_HCI_ACL_FLOW_CONTROL=y
#CONFIG_NET_BUF_LOG=y
#CONFIG_NET_BUF_LOG_LEVEL_DBG=y
#CONFIG_NET_BUF_SIMPLE_LOG=y
#CONFIG_NET_BUF_POOL_USAGE=y

# LORA 
CONFIG_SPI=y
CONFIG_LORA=y
CONFIG_LORA_SHELL=y
CONFIG_LORAWAN=y
CONFIG_LORA_SX126X=y
CONFIG_LORAMAC_REGION_EU868=y
#CONFIG_LORA_LOG_LEVEL_DBG=y
#CONFIG_LORAWAN_LOG_LEVEL_DBG=y
CONFIG_MPU_ALLOW_FLASH_WRITE=y

# GPS
CONFIG_GPS_PARSER_LOG_LEVEL_DBG=y

# LoRaWAN Client
CONFIG_LORAWAN_CLIENT_LOG_LEVEL_DBG=y
